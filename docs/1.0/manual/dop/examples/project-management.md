# 场景示例

## 业务项目管理
该示例旨在介绍如何使用 Devops 平台管理一个需求从设计到开发再到上线的完整生命周期。

假设我们现在有一个 '商城系统' 的项目，项目中有 **项目经理**，**产品经理**，**研发主管**，**测试工程师**，**前端开发工程师**，**后端开发工程师** 这几个角色，在这个项目的一次周期为一周的迭代里的目标是完成一个用户的注册，注销，更新，查看的需求并上线。那么我们将使用 erda 按照以下几个阶段去完成这个迭代：
1. 需求设计
2. 开发  
   2.1. 分发任务  
   2.2. API 设计  
   2.3. 具体开发  
3. 提测
4. 上线
5. 简单监控
6. 迭代质量

![](http://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/08/05/a235ef6c-c1b2-40ca-a500-dfb55b02c81c.png)

### 需求设计
首先进到项目协同页面中，可以看到项目协同的导航栏上有：'迭代'，'需求'，'任务'，'缺陷'等事项类型。一个'需求'/'任务'/'缺陷'一般会属于一个开发周期的'迭代'中。更多详细概念可以参考[项目协同](../guides/project/agile.md)。

项目协同入口位于：

> "Devops 平台 -> 我的项目 -> 点击进入一个项目 -> 项目协同"

点击导航栏上的'迭代'进入到迭代页面，创建一个期限为一周，名字叫 '*迭代-1.0*' 的迭代。后文中创建的需求，缺陷，任务都将纳入该迭代中。

![](http://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/07/30/a52aa774-e9f7-4a7e-a5aa-0536dcbf6355.png)

由 **产品经理** 新建一个名叫 '*用户系统*' 的需求，将该需求纳入 '*迭代-1.0*' 迭代中，并将需求描述，设计稿等信息记录到需求单中。

![](http://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/07/30/2ec6938c-eb4a-4218-b918-9be97eeb4739.png)

需求创建完毕后，进行需求评审。

产品经理创建一个名叫 '*用户系统需求评审*' 的任务，并在下方的关联事项中关联 '*用户系统*' 需求，表示这个任务是和这个需求相关的(后文中创建的所有相关事项都将关联这个需求)，并组织相关测试开发同学进行线下或线上的需求评审，讨论该需求的合理性，复杂性，工作量等相关适宜。评审完后的信息可同步至该任务的评论或者描述中，方便后续回看。

![](http://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/07/30/326664d1-650a-430c-a765-dad3f3a30be8.png)

### 开发
在需求设计完后，会进入具体开发和测试用例设计和评审的工作阶段。

#### 分发任务
由 **研发主管** 对需求的开发工作进行拆分，并创建出各个任务分配给各个开发同学，如用户增删的开发任务分配给A开发工程师，用户改查的任务分配给B开发工程师。

由 **测试工程师** 新建任务 '*用户系统测试用例编写*' 和 '*用户系统测试用例评审*' 指派给相关测试同学。并开始编写测试用例，如何使用测试平台编写测试用例可以查看[测试平台](../testing/function-test.md)。

这些任务都会关联到 '*用户系统*' 需求。

![](http://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/07/30/0df3b608-6aa4-495c-92ad-552e03102de9.png)

#### API 设计
领到开发任务的后端同学，会遵循 API-First 的原则，使用 [API 设计](../api-management.md) 的功能，先对开发工作中涉及的相关 API 进行定义。

> "Devops 平台 -> 我的项目 -> 点击进入一个项目 -> 应用列表 -> 点击进入一个应用 -> API 设计"

在 API 设计中选择一个文档，点击编辑，在 API 列表中选择新建 API 并在右侧输入 API 的相关信息，保存。

![](http://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/07/30/857b5131-3ce2-4b1c-8548-7184b168b194.png)

#### 具体开发
前后端同学在具体开发工作完成后，将代码合入了主干分支。通过  CICD 将主干分支部署至测试环境。

### 提测

#### 冒烟测试
由 **测试工程师** 新建任务 '*用户系统冒烟测试*' 给对应的开发同学，由开发同学根据测试用例在测试环境上进行冒烟测试，并修复冒烟测试中出现的 Bug，直到冒烟测试通过率100%，标记该冒烟测试任务已完成。

#### 提测
冒烟完成后，**测试工程师** 新建任务 '*用户系统一轮测试*' 给自己。测试同学根据测试用例进行测试，测试过程中如果出现 Bug，则标记该条测试用例不通过，并新建缺陷并指派给相关开发同学进行修复，开关同学修复后将缺陷标记为已解决并转回给测试，测试同学针对该缺陷再次进行测试，如果通过则标记 Bug 的状态为已关闭，转回给相关开发同学。直到测试用例通过率100%，标记该测试任务完成。

![](http://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/07/30/a365eafd-6885-49ec-a184-ab4fb82a9b8a.png)

#### 缺陷跟踪
在项目协同的看板页，过滤条件设置成：迭代为 *迭代-1.0*，事项类型为缺陷。就能看到当前迭代所有的 Bug 的状态以及详情。

![](http://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/07/30/f4b8a661-7bb0-4b81-a7b1-ed04f87164f7.png)

开发同学将按照如下流程对自己处理的 Bug 进行流转。从图中可以看到，当 Bug 标记为已解决转给测试的同时，可以在 Bug 单中关联自己修复该问题的 MR，方便后续追踪。

![](http://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/07/29/5aceb444-b9a0-4c8d-8743-6dba765cba5e.png)

### 上线
当该迭代下的所有事项均完成后，开始把 *v1.0* 这个版本通过主干分支的 CICD 自动化部署到生产环境，发布上线。如果线上新版本出现严重问题，可以在 erda 上一键回滚到上个版本。

![](http://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/07/30/789f1380-97d5-4d61-b47d-a70585de8516.png)

### 简单监控
应用上线后，可以通过 erda 上的应用监控功能来查看新版本是否工作正常，如可以通过查看新版应用使用资源详情来确定新应用的实例是否正常运行或稳定，也可以使用全链路追踪查看新版本的组件的调用方是否有失败请求，慢请求的地方。更多监控使用信息可以参考[监控详情](../../msp/guides/apm/topology.md)

监控入口位于：

> "Devops 平台 -> 我的项目 -> 点击进入一个项目 -> 应用列表 -> 点击进入一个应用 -> 部署中心 -> 服务插件 -> 应用监控"

![](http://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/08/18/5675c9f0-ca3c-49cf-886c-35867feb019a.png)


### 迭代质量
**项目经理** 在这整个迭代周期内如何去把控进度以及风险呢，在项目协同页可以看到迭代的进度。  

![](http://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/08/09/4ecfedf1-d8b0-4bd0-aa30-91d3034875ed.png)

同时在 erda 上的项目大盘上也可以直观的看到缺陷分布情况，修复进度，修复工作量等信息。同时也可以在项目协同页通过不同的看板来查看当前迭代所有事项的完成情况以及迭代完成进度的百分比。以便及时调整迭代内的工作安排保证该次迭代的按时交付以及质量。

项目大盘入口位于
> "Devops 平台 -> 我的项目 -> 点击进入一个项目 -> 项目大盘"

![](http://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/07/30/a5fa0820-2812-4257-92ee-a7565b617a72.png)  
