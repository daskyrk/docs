# 分析规则

日志分析规则，实质上是一种将 Log 数据转换为 Metrics 数据的工具。从日志数据转换出的指标数据会进一步流入指标处理系统，进而可以用于搭建 `运维大盘` 和创建 `自定义告警规则`。

## 创建分析规则

创建日志分析规则，实际是在定义如何将一条日志数据转换为指标数据的规则。如下图所示是创建分析规则表单页面：

![](http://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/08/09/2f19a8f3-e093-498d-ad5c-2e63d9f9ea4d.png)

- **选择模版**：模版是一组内置的提取规则，可以通过模版自动填入示例的配置，然后再做调整
- **指标名称**：自定义的指标名称
- **日志筛选**：根据日志的标签过滤，只有带有指定标签的日志才会进一步转换为指标
- **指标提取方式**：当前仅支持正则表达式一种提取方式
- **指标提取正则表达式**：只有捕获组中的匹配内容才会识别为提取的指标的字段。支持多个捕获组，对应分别转换为多个字段
- **提取结果**：当填写至少包含一个捕获组的正则表达式后，点击页面其他位置使输入焦点离开正则表达式的输入框，则提取结果会展示检测到到捕获组并展示为对应行数，每一行代表将要转换为的指标的一个字段，你可以为每个字段设置标示、类型和别名
- **规则测试**：输入日志样例，点击 `分析` 按钮，`分析结果` 处将展示匹配的结果，如果结果不符合预期，可以重新调整正则表达式后再次分析

确认无误后，点击右下角 `确定` 提交即完成分析规则的创建。创建后在创建 `自定义告警规则` 页面 和 创建 `运维大盘` 页面即可选择 `Log Metrics` -> `your created log metrics name` 使用。