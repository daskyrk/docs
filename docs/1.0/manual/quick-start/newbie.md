# 快速入门

## Intro
旨在给从未使用过 Erda 的人快速方便的从 0 开始，一步一步，最终能够对 Erda 有一个清晰和全面的认识。

快速入门将包含：
* 1
* 2
* 3

但不包含以下内容：
* 设计理念阐述
* 全功能讲解
* 最佳实践讲解

## 预备知识
一、清楚 容器/docker 的使用方法，运行机制
Erda 是云原生一站式的 PaaS 平台，容器是其运行的核心。当然 Erda 也存在许多功能与容器关系不大，但我们仍希望用户对容器能有充分的理解。

二、熟知或者知道 java 的基本概念，比如 maven 构建、基于 java 的微服务部署形式
由于本文后续将以 java 程序作为案例，所以希望读者至少能够对 java 有一个基本的认识。但本文不会提及 java 编程相关知识，我们尽量做到去语言化，整个构建流程以及服务治理等在不同语言之间其实是相通的。

## 如果你需要从“装机”开始
请首先阅读 Erda 安装手册【link】，本文预设读者已准备好了 Erda 平台。你同样可以选择使用 erda.cloud，注册个人账号即可使用。

## 环境的准备
:::tip
如果你已经获得了一个项目（Project），那可以跳过本节的准备动作。
:::

### 进入租户

Erda 存在租户的概念，在 Erda 中称之为组织（Org），每个组织之间数据不互通。

如果你是自建的 Erda 平台。请先登录 admin 账号，进行组织的创建。组织的创建非常简单，按照表单的指引进行操作即可。

TODO: admin 创建组织图

如果你没有 admin 账号，请联系平台管理员。

如果你正在使用 erda.cloud，我们所有新用户均可以有一次创建组织的机会，具体为登录你自己的账号，在个人工作台点击创建组织。

TODO: erda.cloud 创建组织图

当然你也可以直接进入公开组织，里边的项目均可以查看。

### 进入项目
:::tip
请确保你的账号是租户管理员。否则请联系租户管理员帮助创建项目。
:::

项目（Project）是 Erda 中大部分功能承载的地方。有两个入口可以创建项目：
1. 组织管理中心，左上角九宫格，进入“管理中心 -> 项目管理 -> 右上角添加项目”
2. 个人工作台（账号必须为组织管理员），左侧栏项目栏“创建”按钮，则会引导至 1）进入创建界面

TODO: 两张入口，一张创建项目图

项目分为三种：
1. DevOps 项目（全功能）
2. 代码托管项目
3. 敏捷项目
TODO: @致信，新版是否已增加微服务治理项目？以及是否有“全功能”这个类型

具体区分可以参看详细介绍【link】，目前仅能创建 DevOps 项目（全功能），其他限制类型的项目（比如你只想使用代码托管，敏捷管理，或者微服务治理功能）暂不支持，尽情期待。

:::warning
创建项目时集群资源可以选填，但是这里请务必选择一个集群，否则会导致后续流程受阻。
如果你没有可选集群，请参看添加集群以及集群资源管理手册【link】，如果你并非组织管理员，请联系组织管理员操作。
:::

进入项目分为两大块功能：
* DevOps
    * 协同
    * 代码托管
    * CI/CD
    * API 管理
    * 测试（包括手动和自动化测试）
* 微服务治理
    * 应用监控
    * API 网关
    * 注册中心&配置中心

由于本教程会进行全流程的演示，覆盖大部分功能，请再次确保给项目配置集群资源，且资源充足（大约需要 TODO cpu 和 TODO mem），具体设置方式请参看集群资源管理手册【link】

## 软件研发全生命周期

TODO: 图示说明从协同到代码到CI/CD到微服务治理到测试回归整套流程

一个正常的软件研发项目会包含以下五个步骤，本文罗列了每个步骤应该使用 Erda 那块功能：
1. 需求分析：协同
2. 架构设计：API 管理
3. 研发实现：代码托管 + CI/CD
4. 质量保障：自动化测试 + 应用监控（微服务治理）
5. 长期运营：微服务治理所有功能

本教程将按上面的软件研发生命周期过程，结合案例进行快速入门的讲解：
1. 需求分析：协同
    * 需求的收集、跟进、过程的落地
3. 研发实现：代码托管 + CI/CD
    * 软件构建、部署、管理
4. 质量保障：自动化测试 + 应用监控（微服务治理）

我们省略了某些步骤，如果你对其有强烈的兴趣，可以参看更详细的场景案例【link】

在开始之前，我们先引入一个虚拟的客户案例：一个高可用的博客网站

## 案例步骤 - 需求分析

我们知道软件研发是一个多人分工、协作的经营活动，当团队人口增长时，口头的协作很难进行下去，这需要有系统/工具来解决这个问题。当然如果你是一位个人开发者我们仍建议你阅读这一章节，如果你事前了解过“协同工具”，就会知道它不仅能够应付团队增长带来的进度沟通问题，也能够很好的帮助每个开发者记录和管理个人的工作。

回到我们的虚拟客户案例，首先我们需要将客户的需求进行分析和抽象。并将需求录入协同：

TODO：协同需求录入图

一半情况来说会由 PD（产品经理）将这个需求内容补充完整，包括详细的需求描述、验收标准等。

当然这个需求最开始会是创建在“待处理”中，在迭代开始前进行评审确定是否放入迭代开发。本文为了方便起见，假使我们已经通过了评审，它被放入了 1.0 迭代：

TODO：需求放入 1.0 图

此时需要我们的 TL（team leader）组织团队进行架构设计（本文暂且省略了这一步），然后进行任务拆解，拆解的任务成为需求的关联事项，可以通过需求跟进进展：

TODO: 任务创建、关联事项以及需求进度图

被指派的开发人员可以方便的基于不同视角观察自己的任务，以及可以评论进度或者提出异议。
我们也非常建议使用任务/缺陷中的关联合并请求功能，这样可以让研发和协同更加紧密，具体使用可以参看【link】

TODO：日常工作图，合并请求图

当然作为项目的管理者，可以通过数据统计分析协同的效率和瓶颈：

TODO：分析大盘图

## 案例步骤 - 研发实现

:::warning
本文中对软件的架构设计不能作为真实研发活动的指导，仅供快速入门 Erda 的参考
:::

对于这个虚拟案例，假设 TL 已经完成架构设计，比如以下设计：
1. 设计两个微服务 service 和 web，使用 dubbo 协议通信，需要 zookeeper 或者其他兼容的注册中心（比如 nacos）
2. 保证可靠性，service 起两个实例
3. 使用 mysql 业务数据存储，redis 存放 session 和缓存

首先需要有两个应用（Application），应用是代码管理和打包部署的最小单位，关于 Erda 应用的解释可以参看详细介绍【link】

TODO: 创建应用图

将代码推送后，需要创建 pipeline.yml，这是一个描述 CI/CD 自动化过程的文件，pipeine 的详细介绍参看【link】。

我们先完成 CI 的部分：

```yaml
version: 1.1

stages:
  - stage:
      - git-checkout:
  - stage:
      - buildpack:
          # TODO
```

将此文件也提交进代码，就可以立马在界面上进行构建：

TODO：推送 pipeline.yml 和执行构建图

当然也可以通过 UI 界面直接操作，省去本地推送：

TODO：界面直接修改 pipeline 图

我们来补完 CD 的部分：

```yaml
version: 1.1

stages:
  - stage:
      - git-checkout:
  - stage:
      - buildpack:
          # TODO
  - stage:
      - release:
          params:
            erda_yaml: ${git-checkout}/erda.yml
            image:
              web: TODO
              service: TODO
  - stage:
      - deploy:
          # TODO
```

可以看到增加了 release 和 deploy 两个步骤，并且出现了 erda.yml 这个新文件。

我们先把这个文件补上，然后提交代码

```yaml
services:
  web:
    # TODO
  service:
    # TODO
addons:
  mysql:
    # TODO
  redis:
    # TODO
```

erda.yml 是 Erda 平台中用于描述部署已经部署环境的文件，通过它，开发者可以不用关心软件部署中环境的准备等基础设施，甚至中间件都是被描述而不是配置的。
erda.yml 本身是 Erda 对 IaC（Infrastructure As Code）理念的体现，如果你对此感兴趣并且想要详细了解 erda.yml 请参看 erda.yml 设计理念【link】以及使用全解【link】。
这里我们只需要知道，这个文件描述了应用/软件的部署，通过它平台就能自动理解如何部署程序了。

另外 erda.yml 最终是需要通过 docker 镜像进行部署的，但是我们提交进代码的 erda.yml 并未填写镜像。这是由于镜像是在 CI 过程中编译出来的，可以看到上面 pipeline.yml 的例子：通过 buildpack 将代码编译打包为 docker 镜像，再通过 release 将镜像自动塞入 erda.yml，最终 deploy 是基于生成后的 erda.yml 的。

待 pipeline 执行完毕成功后，就可以在部署中心看到发布成功的实例，具体的运维管理操作（比如重启、回滚、查看日志等）不再赘述，如需全面了解可以参看应用管理场景案例【link】

## 案例步骤 - 质量保障

质量保障牵扯到研发过程所有环节。
测试方面就有比如有代码扫描、单元测试，以及代码审查等研发前期卡点，还有集成时的自动化测试、人工探索和回归测试等，本章节方便快速入门，只选用自动化测试功能进行介绍，关于软件测试的全功能解释、设计理念、最佳实践等参看【link】

自动化测试的入口在 项目 -> 测试管理 -> 测试用例 -> 自动化测试

用虚拟项目为例，假设我们设计了如此功能：
1. 文章列表
2. 点击文章查看详情
3. 用户每次点击进入阅读量 +1

首先创建场景目录：“文章”，再创建单个场景：“文章阅读数”

TODO: 创建场景集/场景图

在场景中添加步骤进行场景编排，我们按照实际操作步骤设置步骤，每个步骤为具体的接口调用：

TODO: 自动化测试中接口配置图

如上图所示，通过配置接口参数以及断言以推进自动化的实现，更详细的功能使用参考详细文档【link】

而在软件上线后也需要通过全链路的追踪和日志分析、告警等功能及时发现问题和故障，以及辅助定位原因。这方面需要我们 case by case 展开逐点探讨，请阅读微服务治理相关的场景案例【link】

## 下一步

本文按照一个普通软件的研发流程对 Erda 的功能进行了粗略的讲解。为了方便快速入门，其中我们缺省了许多需要深入学习的功能，比如 API 管理、微服务治理中的 API 网关等，其中对注册中心、配置中心也只是点到为止。如果你需要深入进一步的学习，请参看更详细的指南【link】